import{withBase as c}from"@vuepress/client";import{isLinkHttp as S}from"@vuepress/shared";import{ref as g,computed as N,unref as m,onMounted as h,isRef as T,watch as P,defineComponent as $,h as C}from"vue";import{useEventListener as w}from"@vueuse/core";import{checkIsMobile as E,checkIsSafari as I}from"vuepress-shared/client";import"../styles/pdf.scss";const v=e=>typeof e=="string"?e:`${e}px`,x=(e,t=0)=>{const o=g(),n=N(()=>v(m(e.width)||"100%")),a=g("auto"),s=r=>{if(typeof r=="string"){const[d,u]=r.split(":"),p=Number(d)/Number(u);if(!Number.isNaN(p))return p}return typeof r=="number"?r:16/9},l=r=>{const d=m(e.height),u=s(m(e.ratio));return d?v(d):`${Number(r)/u+m(t)}px`},i=()=>{o.value&&(a.value=l(o.value.clientWidth))};return h(()=>{i(),T(t)&&P(t,()=>i()),w("orientationchange",()=>i()),w("resize",()=>i())}),{el:o,width:n,height:a}},L="/assets/lib/pdfjs/web/viewer.html",b=e=>{console.error("[PDF]: "+e)},R=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},j=e=>e==="string"?document.querySelector(e):e instanceof HTMLElement?e:document.body,F=e=>{let t="";return e&&(t+=Object.entries(e).map(([o,n])=>o==="noToolbar"?`toolbar=${n?0:1}`:`${encodeURIComponent(o)}=${encodeURIComponent(n)}`).join("&"),t&&(t="#"+t,t=t.slice(0,t.length-1))),t},M=(e,t,o,n,a)=>{R(t);let s=o;e==="pdfjs"&&(s=c(L)+"?file="+encodeURIComponent(o)+F(n));const l=e==="pdfjs"||e==="iframe"?"iframe":"embed",i=document.createElement(l);return i.className="pdf-viewer",i.type="application/pdf",i.title=a,i.src=s,i instanceof HTMLIFrameElement&&(i.allow="fullscreen"),t.classList.add("pdf-viewer-container"),t.appendChild(i),t.getElementsByTagName(l)[0]},z=(e,t=null,{title:o,options:n={}})=>{var a;if(typeof window>"u"||window.navigator===void 0||window.navigator.userAgent===void 0||window.navigator.mimeTypes===void 0)return null;const s=window.navigator,l=window.navigator.userAgent,i=window.Promise!==void 0,r=s.platform!==void 0&&s.platform==="MacIntel"&&s.maxTouchPoints!==void 0&&s.maxTouchPoints>1||E(l),d=!r&&I(l),u=!r&&/irefox/.test(l)&&l.split("rv:").length>1?parseInt(l.split("rv:")[1].split(".")[0],10)>18:!1,p=!r&&(i||u);if(typeof e!="string")return b("URL is not valid"),null;const f=j(t);if(!f)return b("Target element cannot be determined"),null;const y=o||((a=/\/([^/]+).pdf/.exec(e))==null?void 0:a[1])||"PDF Viewer";return M(p||!r?d?"iframe":"embed":"pdfjs",f,e,n,y)};var D=$({name:"PDF",props:{url:{type:String,required:!0},title:{type:String,default:""},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:void 0},ratio:{type:[String,Number],default:16/9},page:{type:[String,Number],default:1},noToolbar:Boolean,zoom:{type:[String,Number],default:100}},setup(e){const{el:t,width:o,height:n}=x(e);return h(()=>{const a=S(e.url)?e.url:__VUEPRESS_SSR__?"":`${(window==null?void 0:window.location.origin)||""}${c(e.url)}`;z(a,t.value,{title:e.title,options:{page:e.page,noToolbar:e.noToolbar,zoom:e.zoom}})}),()=>C("div",{class:"pdf-preview",ref:t,style:{width:o.value,height:n.value}})}});export{D as default};
//# sourceMappingURL=PDF.js.map
