{"version":3,"file":"config.js","sources":["../../src/client/components/LightGallery.ts","../../src/client/config.ts"],"sourcesContent":["import lightGallery from \"lightgallery/lightgallery.es5.js\";\nimport {\n  defineComponent,\n  h,\n  onBeforeUnmount,\n  onMounted,\n  ref,\n  watch,\n} from \"vue\";\nimport { useRoute } from \"vue-router\";\n\nimport type { LightGallery } from \"lightgallery/lightgallery.js\";\nimport type { LightGallerySettings } from \"lightgallery/lg-settings.js\";\nimport type { LgQuery } from \"lightgallery/lgQuery.js\";\nimport type { GalleryItem } from \"lightgallery/lg-utils.js\";\nimport type { VNode } from \"vue\";\n\nimport \"lightgallery/scss/lightgallery.scss\";\n\ntype LightGalleryPlugin<T = unknown> = {\n  default: new (instance: LightGallery, $LG: LgQuery) => T;\n};\n\ndeclare const IMAGE_SELECTOR: string;\ndeclare const LIGHT_GALLERY_DELAY: number;\ndeclare const LIGHT_GALLERY_OPTIONS: LightGallerySettings;\ndeclare const LIGHT_GALLERY_AUTOPLAY: boolean;\ndeclare const LIGHT_GALLERY_FULLSCREEN: boolean;\ndeclare const LIGHT_GALLERY_PAGER: boolean;\ndeclare const LIGHT_GALLERY_THUMBNAIL: boolean;\ndeclare const LIGHT_GALLERY_ROTATE: boolean;\ndeclare const LIGHT_GALLERY_SHARE: boolean;\ndeclare const LIGHT_GALLERY_ZOOM: boolean;\n\nconst getImages = (images: HTMLImageElement[]): GalleryItem[] =>\n  images.map(\n    ({ alt, srcset, src }) =>\n      <GalleryItem>{\n        alt: alt,\n        src: src,\n        thumb: src || srcset,\n        srcset: srcset,\n        subHtml: alt,\n      }\n  );\n\nexport default defineComponent({\n  name: \"LightGallery\",\n\n  setup(_props, { slots }) {\n    const route = useRoute();\n    const container = ref<HTMLElement>();\n    let instance: LightGallery | null = null;\n    let id: number;\n\n    const plugins: Promise<LightGalleryPlugin>[] = [];\n    const pluginsStyles: unknown[] = [];\n\n    if (LIGHT_GALLERY_AUTOPLAY) {\n      plugins.push(\n        <Promise<LightGalleryPlugin>>(\n          import(\"lightgallery/plugins/autoplay/lg-autoplay.es5.js\")\n        )\n      );\n      pluginsStyles.push(import(\"lightgallery/scss/lg-autoplay.scss\"));\n    }\n\n    if (LIGHT_GALLERY_FULLSCREEN) {\n      plugins.push(\n        <Promise<LightGalleryPlugin>>(\n          import(\"lightgallery/plugins/fullscreen/lg-fullscreen.es5.js\")\n        )\n      );\n      pluginsStyles.push(import(\"lightgallery/scss/lg-fullscreen.scss\"));\n    }\n\n    if (LIGHT_GALLERY_PAGER) {\n      plugins.push(\n        <Promise<LightGalleryPlugin>>(\n          import(\"lightgallery/plugins/pager/lg-pager.es5.js\")\n        )\n      );\n      pluginsStyles.push(import(\"lightgallery/scss/lg-pager.scss\"));\n    }\n\n    if (LIGHT_GALLERY_ROTATE) {\n      plugins.push(\n        <Promise<LightGalleryPlugin>>(\n          import(\"lightgallery/plugins/rotate/lg-rotate.es5.js\")\n        )\n      );\n      pluginsStyles.push(import(\"lightgallery/scss/lg-rotate.scss\"));\n    }\n\n    if (LIGHT_GALLERY_SHARE) {\n      plugins.push(\n        <Promise<LightGalleryPlugin>>(\n          import(\"lightgallery/plugins/share/lg-share.es5.js\")\n        )\n      );\n      pluginsStyles.push(import(\"lightgallery/scss/lg-share.scss\"));\n    }\n\n    if (LIGHT_GALLERY_THUMBNAIL) {\n      plugins.push(\n        <Promise<LightGalleryPlugin>>(\n          import(\"lightgallery/plugins/thumbnail/lg-thumbnail.es5.js\")\n        )\n      );\n      pluginsStyles.push(import(\"lightgallery/scss/lg-thumbnail.scss\"));\n    }\n\n    if (LIGHT_GALLERY_ZOOM) {\n      plugins.push(\n        <Promise<LightGalleryPlugin>>(\n          import(\"lightgallery/plugins/zoom/lg-zoom.es5.js\")\n        )\n      );\n      pluginsStyles.push(import(\"lightgallery/scss/lg-zoom.scss\"));\n    }\n\n    const initLightGallery = (): void => {\n      const timeID = (id = new Date().getTime());\n\n      void Promise.all([\n        Promise.all(plugins),\n        Promise.all(pluginsStyles),\n        new Promise<void>((resolve) =>\n          setTimeout(resolve, LIGHT_GALLERY_DELAY)\n        ),\n      ]).then(([plugins]) => {\n        if (timeID === id) {\n          instance?.destroy();\n\n          const images = Array.from(\n            document.querySelectorAll<HTMLImageElement>(IMAGE_SELECTOR)\n          );\n\n          instance = new lightGallery(container.value!, {\n            ...LIGHT_GALLERY_OPTIONS,\n            dynamic: true,\n            dynamicEl: getImages(images),\n            // this is a licenseKey to make this project under MIT, special thanks to @Sachin\n            licenseKey: \"VSY7R-J@WED-CJY76-UMDXQ\",\n            plugins: plugins.map(({ default: plugin }) => plugin),\n          });\n\n          images.forEach((image, index) => {\n            image.addEventListener(\"click\", () => {\n              instance?.openGallery(index);\n            });\n          });\n        }\n      });\n    };\n\n    watch(\n      () => route.path,\n      () => initLightGallery()\n    );\n\n    onMounted(() => initLightGallery());\n\n    onBeforeUnmount(() => instance?.destroy());\n\n    return (): VNode =>\n      h(\n        \"div\",\n        { ref: container, class: \"lightgallery-vuepress\" },\n        slots[\"default\"]?.()\n      );\n  },\n});\n","import { defineClientConfig } from \"@vuepress/client\";\nimport LightGallery from \"./components/LightGallery.js\";\n\nexport default defineClientConfig({\n  rootComponents: [LightGallery],\n});\n"],"names":["getImages","images","alt","srcset","src","t","defineComponent","_props","slots","route","useRoute","container","ref","instance","id","plugins","pluginsStyles","initLightGallery","timeID","resolve","lightGallery","plugin","image","index","watch","onMounted","onBeforeUnmount","_a","h","defineClientConfig","LightGallery"],"mappings":"6RAkCA,MAAMA,EAAaC,GACjBA,EAAO,IACL,CAAC,CAAE,IAAAC,EAAK,OAAAC,EAAQ,IAAAC,CAAI,KACL,CACX,IAAKF,EACL,IAAKE,EACL,MAAOA,GAAOD,EACd,OAAQA,EACR,QAASD,CACX,EACJ,EAEF,IAAAG,EAAeC,EAAgB,CAC7B,KAAM,eAEN,MAAMC,EAAQ,CAAE,MAAAC,CAAM,EAAG,CACvB,MAAMC,EAAQC,EAAS,EACjBC,EAAYC,IAClB,IAAIC,EAAgC,KAChCC,EAEJ,MAAMC,EAAyC,CACzCC,EAAAA,EAA2B,CAAA,EAE7B,yBACFD,EAAQ,KAEJ,OAAO,mDAEX,EACAC,EAAc,KAAK,OAAO,qCAAqC,GAG7D,2BACFD,EAAQ,KAEJ,OAAO,uDAEX,EACAC,EAAc,KAAK,OAAO,uCAAuC,GAG/D,sBACFD,EAAQ,KAEJ,OAAO,6CAEX,EACAC,EAAc,KAAK,OAAO,kCAAkC,GAG1D,uBACFD,EAAQ,KAEJ,OAAO,+CAEX,EACAC,EAAc,KAAK,OAAO,mCAAmC,GAG3D,sBACFD,EAAQ,KAEJ,OAAO,6CAEX,EACAC,EAAc,KAAK,OAAO,kCAAkC,GAG1D,0BACFD,EAAQ,KAEJ,OAAO,qDAEX,EACAC,EAAc,KAAK,OAAO,sCAAsC,GAG9D,qBACFD,EAAQ,KAEJ,OAAO,2CAEX,EACAC,EAAc,KAAK,OAAO,iCAAiC,GAG7D,MAAMC,EAAmB,IAAY,CACnC,MAAMC,EAAUJ,EAAK,IAAI,OAAO,QAE3B,EAAA,QAAQ,IAAI,CACf,QAAQ,IAAIC,CAAO,EACnB,QAAQ,IAAIC,CAAa,EACzB,IAAI,QAAeG,GACjB,WAAWA,EAAS,mBAAmB,CACzC,CACF,CAAC,EAAE,KAAK,CAAC,CAACJ,CAAO,IAAM,CACrB,GAAIG,IAAWJ,EAAI,CACjBD,GAAA,MAAAA,EAAU,UAEV,MAAMZ,EAAS,MAAM,KACnB,SAAS,iBAAmC,cAAc,CAC5D,EAEAY,EAAW,IAAIO,EAAaT,EAAU,MAAQ,CAC5C,GAAG,sBACH,QAAS,GACT,UAAWX,EAAUC,CAAM,EAE3B,WAAY,0BACZ,QAASc,EAAQ,IAAI,CAAC,CAAE,QAASM,CAAO,IAAMA,CAAM,CACtD,CAAC,EAEDpB,EAAO,QAAQ,CAACqB,EAAOC,IAAU,CAC/BD,EAAM,iBAAiB,QAAS,IAAM,CACpCT,GAAA,MAAAA,EAAU,YAAYU,CAAAA,CACxB,CAAC,CACH,CAAC,CACH,CACF,CAAC,CACH,EAEA,OAAAC,EACE,IAAMf,EAAM,KACZ,IAAMQ,EAAAA,CACR,EAEAQ,EAAU,IAAMR,GAAkB,EAElCS,EAAgB,IAAMb,GAAA,KAAAA,OAAAA,EAAU,QAAS,CAAA,EAElC,IAAU,CArKrB,IAAAc,EAsKM,OAAAC,EACE,MACA,CAAE,IAAKjB,EAAW,MAAO,uBAAwB,GACjDgB,EAAAnB,EAAM,UAAN,YAAAmB,EAAA,KAAAnB,CACF,CAAA,CAAA,CACJ,CACF,CAAC,ECzKcqB,EAAAA,EAAmB,CAChC,eAAgB,CAACC,CAAY,CAC/B,CAAC"}